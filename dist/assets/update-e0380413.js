import{_ as w,G as k,a7 as D,bp as T,c as n,r as p,o as m,d as u,e as a,t as l,f as o,w as F,E as c,F as v,z as S,g,D as L,T as E}from"./main-3e20b4b3.js";import{F as N,i as P,a as U,b as B,c as G,l as y}from"./index-79f49809.js";import"./moment-fbc5633a.js";const I={components:{FullCalendar:N,Calendar:k},data(){return{doctors:{},admin_id:"",deleteDialog:!1,submitted:!1,setiontype:"",programes:{},child:{},rooms:{},error:{},doctors:{},isSubmitting:!1,programe_type:{},toast:D(),student:{time_slots:[]},capasityboj:{},capasity:[],maxcapsity:"",treaments:{},time_slotename:[],buttomaddcal:!0,timeshow:!1,FullCalendarshow:!1,langStore:T(),opts:{plugins:[P,U,B,G],initialView:"dayGridMonth",footerToolbar:!0,valid:!1,buttonIcons:!1,locale:null,validRange:{start:new Date},selectable:!1,droppable:!1,editable:!0,selectHelper:!0,validRange:{start:new Date},headerToolbar:{center:"prev next today",left:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},eventsTimeFormat:{hour:"2-digit",minute:"2-digit",second:"2-digit"},eventClick:(function(t){this.student.time_slots.some(e=>e.time_slot_id==t.event.id)?(t.event.setProp("backgroundColor","blue"),this.student.time_slots.splice(this.student.time_slots.findIndex(e=>e.time_slot_id==t.event.id),1)):(t.event.setProp("backgroundColor","green"),this.student.time_slots.push({time_slot_id:t.event.id})),console.log(this.student.time_slots)}).bind(this)}}},methods:{deleteitem(t){this.capasity.splice(t,1)},getAllDocto(){n.get("api/doctors").then(t=>{this.doctors=t.data.doctors,console.log(this.doctors)}).catch(t=>{console.error("Error retrieving doctors:",t)})},deletearray(){this.capasity.length=[],this.maxcapsity=this.refmaxcapsity},addarray(){this.capasity.push({treatment_id:this.student.Type,sessions_number:this.student.sessions_number,name:this.treaments.find(t=>t.id==this.student.Type).name}),this.maxcapsity=this.maxcapsity-this.student.sessions_number,this.student.sessions_number=""},getprograme(t){this.capasity=[],this.student.sessions_number="",n.get(`/api/program/${this.student.program_id}`).then(e=>{this.refmaxcapsity=e.data.data.individual_sessions,this.maxcapsity=e.data.data.individual_sessions,this.setiontype=e.data.data.session_type}),n.get(`api/slot/filter/${t}`).then(e=>{this.opts.events=e.data.data.map(r=>({title:r.title,start:r.start,end:r.end,id:r.id,from:r.from}))})},getalltreatement(){n.get("api/treatment/all").then(t=>{this.treaments=t.data.data,this.getOne(),console.log(this.doctors)})},getallchild(){n.get("api/child").then(t=>{this.child=t.data.children})},getOne(){n.get(`api/student-program/${this.$route.params.id}`).then(t=>{this.student.student_id=t.data.data.student_id,this.student.program_id=t.data.data.program_id,this.maxcapsity=t.data.data.program.individual_sessions,t.data.data.student_program_details.forEach(e=>{this.maxcapsity=this.maxcapsity-e.sessions_number}),this.capasity=t.data.data.student_program_details.map(e=>({treatment_id:e.treatment_id,sessions_number:e.sessions_number,name:e.treatment.name})),this.opts.events=t.data.data.time_slots.map(e=>({title:e.title,start:e.start,end:e.end,id:e.id,from:e.from}))})},getallprogrames(){n.get("api/program").then(t=>{this.programes=t.data.data})},updatePrograme(){n.put(`/api/student-program/${this.$route.params.id}`,{program_id:this.student.program_id,student_id:this.student.student_id,details:this.capasity,time_slots:this.student.time_slots,shared_slots:this.maxcapsity}).then(t=>{this.$toast.add({severity:"success",summary:this.$t("success_message"),detail:`${this.$t("element_add_success")}`,life:3e3})}).catch(t=>{this.$toast.add({severity:"error",summary:this.$t("error"),detail:`${t.response.data.message}`,life:3e3})})},highlightSelectedDay(t){this.$store.state.calendar.selectedDay===t.dateStr&&t.el.classList.add("selected-day")},loo(){localStorage.appLang=="en"?console.log("ascasc"):this.opts.locale=y},refreshEvents(){this.$refs.calendar.$emit("refetch-events")}},mounted(){this.getallprogrames(),this.getallchild(),this.getalltreatement(),localStorage.appLang=="en"?console.log("ascasc"):this.opts.locale=y},watch:{"langStore.appLang"(t){t=="en"?this.opts.locale="":this.opts.locale=y}}},R={class:"text-xl p-4 text-[#135C65] cursor-pointer font-bold"},q={class:"p-[2%] bg-[#FDFDFD] grid grid-cols-1 lg:grid-cols-2 gap-4"},A={class:"flex flex-column gap-2"},M={for:"username"},j={class:"flex flex-column gap-2"},z={for:"username"},O=a("th",null," عدد الجسات الفردية + الجماعية ",-1),W={key:0},H={class:"px-4"},J={key:0,class:"mt-1 mb-5 text-red-500"},K=a("div",{class:"card flex justify-content-center"},null,-1),Q={class:"flex flex-column gap-2 w-full"};function X(t,e,r,Y,s,d){const h=p("Dropdown"),_=p("Button"),x=p("InputNumber"),C=p("Toast"),V=p("FullCalendar");return m(),u(v,null,[a("div",null,[a("div",null,[a("p",R,l(t.$t("add_sp")),1)])]),o(E,null,{default:F(()=>{var f;return[a("form",{onSubmit:e[6]||(e[6]=L((...i)=>d.updatePrograme&&d.updatePrograme(...i),["prevent"]))},[a("div",q,[a("div",A,[a("label",M,l(t.$t("ProgramName")),1),o(h,{required:"",id:"pv_id_1",style:{direction:"ltr !important"},modelValue:s.student.program_id,"onUpdate:modelValue":[e[0]||(e[0]=i=>s.student.program_id=i),d.getprograme],"option-value":"id",filter:"",options:s.programes,optionLabel:"name",class:c({"p-invalid":s.submitted&&!s.student.program_id})},null,8,["modelValue","onUpdate:modelValue","options","class"])]),a("div",j,[a("label",z,l(t.$t("child_name")),1),o(h,{required:"",id:"pv_id_1",style:{direction:"ltr !important"},modelValue:s.student.student_id,"onUpdate:modelValue":[e[1]||(e[1]=i=>s.student.student_id=i),t.getAllDoctor],"option-value":"id",filter:"",options:s.child,optionLabel:"name",placeholder:t.$t("child_name"),class:c({"p-invalid":s.submitted&&!s.student.student_id})},null,8,["modelValue","onUpdate:modelValue","options","placeholder","class"])])]),s.student.program_id&&s.setiontype!=1?(m(),u("table",{key:0,class:c([{"animate__animated animate__bounce animate__delay-0s":s.error.balance},"item-table w-[70%]"])},[a("thead",null,[a("tr",null,[a("th",null,l(t.$t("Typetreatment")),1),a("th",null,l(t.$t("number_sessaion")),1),O])]),a("tbody",null,[(m(!0),u(v,null,S(s.capasity,(i,b)=>(m(),u("tr",{key:b},[a("td",null,l(i.name),1),a("td",null,l(i.sessions_number),1),a("td",null,l(s.maxcapsity),1),a("td",null,[o(_,{onClick:Z=>d.deleteitem(b),icon:"pi pi-trash",class:"p-button-rounded delete p-button-success m-auto"},null,8,["onClick"])])]))),128)),s.student.program_id&&s.maxcapsity>0&&s.setiontype!=1?(m(),u("tr",W,[a("td",null,[o(h,{required:"",id:"pv_id_1",style:{direction:"ltr !important"},modelValue:s.student.Type,"onUpdate:modelValue":e[2]||(e[2]=i=>s.student.Type=i),"option-value":"id",filter:"",options:s.treaments,optionLabel:"name",placeholder:t.$t("Typetreatment"),class:c(["w-full",{"p-invalid":s.submitted&&!s.student.Type}])},null,8,["modelValue","options","placeholder","class"])]),a("td",null,[o(x,{max:s.maxcapsity,min:1,class:"bg-[#f7f5f5] w-full",modelValue:s.student.sessions_number,"onUpdate:modelValue":e[3]||(e[3]=i=>s.student.sessions_number=i),placeholder:t.$t("Sn")},null,8,["max","modelValue","placeholder"])]),a("td",null,l(s.maxcapsity),1),a("td",null,[o(_,{onClick:d.addarray,type:"submit",class:"create m-auto s",icon:"pi pi-plus"},null,8,["onClick"])])])):g("",!0)])],2)):g("",!0),o(C),a("div",H,[o(V,{options:s.opts,class:"h-[400px]",onChange:e[4]||(e[4]=i=>d.refreshEvents()),ref:"fullCalendar",dayRender:d.highlightSelectedDay},null,8,["options","dayRender"]),(f=s.error)!=null&&f.time_slots?(m(),u("div",J,l(s.error.time_slots[0]),1)):g("",!0),K,a("div",Q,[o(_,{type:"submit ",onClick:e[5]||(e[5]=i=>s.submitted=!0),class:"create m-auto w-full lg:w-[50%]",label:t.$t("submit")},null,8,["label"])])])],32)]}),_:1})],64)}const st=w(I,[["render",X]]);export{st as default};
