import{_ as w,H as k,a7 as D,bo as T,c as r,r as p,o as u,d as m,e as s,t as o,f as a,w as F,E as c,F as v,z as S,g,D as L,T as N}from"./main-89bbefe8.js";import{F as U,i as B,a as E,b as G,c as I,l as y}from"./index-2c2beff6.js";import"./moment-fbc5633a.js";const R={components:{FullCalendar:U,Calendar:k},data(){return{doctors:{},admin_id:"",deleteDialog:!1,submitted:!1,setiontype:"",programes:{},child:{},rooms:{},error:{},doctors:{},isSubmitting:!1,programe_type:{},toast:D(),student:{time_slots:[]},capasityboj:{},capasity:[],maxcapsity:"",treaments:{},time_slotename:[],buttomaddcal:!0,timeshow:!1,FullCalendarshow:!1,langStore:T(),opts:{plugins:[B,E,G,I],initialView:"dayGridMonth",footerToolbar:!0,valid:!1,buttonIcons:!1,locale:null,validRange:{start:new Date},selectable:!1,droppable:!1,editable:!0,selectHelper:!0,validRange:{start:new Date},headerToolbar:{center:"prev next today",left:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},eventsTimeFormat:{hour:"2-digit",minute:"2-digit",second:"2-digit"},eventClick:(function(e){this.student.time_slots.some(l=>l.time_slot_id==e.event.id)?(e.event.setProp("backgroundColor","blue"),this.student.time_slots.splice(this.student.time_slots.findIndex(l=>l.time_slot_id==e.event.id),1)):(e.event.setProp("backgroundColor","green"),this.student.time_slots.push({time_slot_id:e.event.id})),console.log(this.student.time_slots)}).bind(this)}}},methods:{deleteitem(e){this.capasity.splice(e,1)},getAllDocto(){r.get("api/doctors").then(e=>{this.doctors=e.data.doctors,console.log(this.doctors)}).catch(e=>{console.error("Error retrieving doctors:",e)})},deletearray(){this.capasity.length=[],this.maxcapsity=this.refmaxcapsity},addarray(){this.capasity.push({treatment_id:this.student.Type,sessions_number:this.student.sessions_number,name:this.treaments.find(e=>e.id==this.student.Type).name}),this.maxcapsity=this.maxcapsity-this.student.sessions_number,this.student.sessions_number=""},getprograme(e){this.capasity=[],this.student.sessions_number="",r.get(`/api/program/${this.student.program_id}`).then(l=>{this.refmaxcapsity=l.data.data.individual_sessions,this.maxcapsity=l.data.data.individual_sessions,this.setiontype=l.data.data.session_type}),r.get(`api/slot/filter/${e}`).then(l=>{this.opts.events=l.data.data.map(d=>({title:d.title,start:d.start,end:d.end,id:d.id,from:d.from}))})},getalltreatement(){r.get("api/treatment/all").then(e=>{this.treaments=e.data.data,console.log(this.doctors)})},getallchild(){r.get("api/child").then(e=>{this.child=e.data.children})},getallprogrames(){r.get("api/program").then(e=>{this.programes=e.data.data})},createtreatment(){r.post("/api/student-program",{program_id:this.student.program_id,student_id:this.student.student_id,details:this.capasity,time_slots:this.student.time_slots,shared_slots:this.maxcapsity}).then(e=>{this.$toast.add({severity:"success",summary:this.$t("success_message"),detail:`${this.$t("element_add_success")}`,life:3e3})}).catch(e=>{this.$toast.add({severity:"error",summary:this.$t("error"),detail:`${e.response.data.message}`,life:3e3})})},highlightSelectedDay(e){this.$store.state.calendar.selectedDay===e.dateStr&&e.el.classList.add("selected-day")},loo(){localStorage.appLang=="en"?console.log("ascasc"):this.opts.locale=y},refreshEvents(){this.$refs.calendar.$emit("refetch-events")}},mounted(){this.getallprogrames(),this.getallchild(),this.getalltreatement(),localStorage.appLang=="en"?console.log("ascasc"):this.opts.locale=y},watch:{"langStore.appLang"(e){e=="en"?this.opts.locale="":this.opts.locale=y}}},q={class:"text-xl p-4 text-[#135C65] cursor-pointer font-bold"},A={class:"p-[2%] bg-[#FDFDFD] grid grid-cols-1 lg:grid-cols-2 gap-4"},M={class:"flex flex-column gap-2"},P={for:"username"},j={class:"flex flex-column gap-2"},z={for:"username"},H=s("th",null," عدد الجسات الفردية + الجماعية ",-1),W={key:0},J={class:"px-4"},K={key:0,class:"mt-1 mb-5 text-red-500"},O=s("div",{class:"card flex justify-content-center"},null,-1),Q={class:"flex flex-column gap-2 w-full"};function X(e,l,d,Y,t,n){const h=p("Dropdown"),_=p("Button"),x=p("InputNumber"),C=p("Toast"),V=p("FullCalendar");return u(),m(v,null,[s("div",null,[s("div",null,[s("p",q,o(e.$t("add_sp")),1)])]),a(N,null,{default:F(()=>{var f;return[s("form",{onSubmit:l[6]||(l[6]=L((...i)=>n.createtreatment&&n.createtreatment(...i),["prevent"]))},[s("div",A,[s("div",M,[s("label",P,o(e.$t("ProgramName")),1),a(h,{required:"",id:"pv_id_1",style:{direction:"ltr !important"},modelValue:t.student.program_id,"onUpdate:modelValue":[l[0]||(l[0]=i=>t.student.program_id=i),n.getprograme],"option-value":"id",filter:"",options:t.programes,optionLabel:"name",class:c({"p-invalid":t.submitted&&!t.student.program_id})},null,8,["modelValue","onUpdate:modelValue","options","class"])]),s("div",j,[s("label",z,o(e.$t("child_name")),1),a(h,{required:"",id:"pv_id_1",style:{direction:"ltr !important"},modelValue:t.student.student_id,"onUpdate:modelValue":[l[1]||(l[1]=i=>t.student.student_id=i),e.getAllDoctor],"option-value":"id",filter:"",options:t.child,optionLabel:"name",placeholder:e.$t("child_name"),class:c({"p-invalid":t.submitted&&!t.student.student_id})},null,8,["modelValue","onUpdate:modelValue","options","placeholder","class"])])]),t.student.program_id&&t.setiontype!=1?(u(),m("table",{key:0,class:c([{"animate__animated animate__bounce animate__delay-0s":t.error.balance},"item-table w-[70%]"])},[s("thead",null,[s("tr",null,[s("th",null,o(e.$t("Typetreatment")),1),s("th",null,o(e.$t("number_sessaion")),1),H])]),s("tbody",null,[(u(!0),m(v,null,S(t.capasity,(i,b)=>(u(),m("tr",{key:b},[s("td",null,o(i.name),1),s("td",null,o(i.sessions_number),1),s("td",null,o(t.maxcapsity),1),s("td",null,[a(_,{onClick:Z=>n.deleteitem(b),icon:"pi pi-trash",class:"p-button-rounded delete p-button-success m-auto"},null,8,["onClick"])])]))),128)),t.student.program_id&&t.maxcapsity>0&&t.setiontype!=1?(u(),m("tr",W,[s("td",null,[a(h,{required:"",id:"pv_id_1",style:{direction:"ltr !important"},modelValue:t.student.Type,"onUpdate:modelValue":l[2]||(l[2]=i=>t.student.Type=i),"option-value":"id",filter:"",options:t.treaments,optionLabel:"name",placeholder:e.$t("Typetreatment"),class:c(["w-full",{"p-invalid":t.submitted&&!t.student.Type}])},null,8,["modelValue","options","placeholder","class"])]),s("td",null,[a(x,{max:t.maxcapsity,min:1,class:"bg-[#f7f5f5] w-full",modelValue:t.student.sessions_number,"onUpdate:modelValue":l[3]||(l[3]=i=>t.student.sessions_number=i),placeholder:e.$t("Sn")},null,8,["max","modelValue","placeholder"])]),s("td",null,o(t.maxcapsity),1),s("td",null,[a(_,{onClick:n.addarray,type:"submit",class:"create m-auto s",icon:"pi pi-plus"},null,8,["onClick"])])])):g("",!0)])],2)):g("",!0),a(C),s("div",J,[a(V,{options:t.opts,class:"h-[400px]",onChange:l[4]||(l[4]=i=>n.refreshEvents()),ref:"fullCalendar",dayRender:n.highlightSelectedDay},null,8,["options","dayRender"]),(f=t.error)!=null&&f.time_slots?(u(),m("div",K,o(t.error.time_slots[0]),1)):g("",!0),O,s("div",Q,[a(_,{type:"submit ",onClick:l[5]||(l[5]=i=>t.submitted=!0),class:"create m-auto w-full lg:w-[50%]",label:e.$t("submit")},null,8,["label"])])])],32)]}),_:1})],64)}const se=w(R,[["render",X]]);export{se as default};
