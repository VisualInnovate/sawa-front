import{_ as Y,m as Z,a1 as ee,q as l,aj as te,a2 as ae,ak as se,r,al as M,o as m,d as U,e as s,f as a,i as f,L as R,g as n,t as c,h as T,j as V,c as w,y as le,z as oe}from"./main-c4167cbc.js";import{L as ne}from"./LeavesNave-653028ac.js";const D=g=>(le("data-v-8f7e7fc2"),g=g(),oe(),g),ie={class:"grid"},re={class:"col-12"},de={class:"card p-4 shadow-2 border-round"},ce={class:"card shadow-1 surface-0"},ue={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center gap-3"},pe={class:"m-0"},ve={class:"flex gap-2"},me={class:"p-input-icon-left"},fe=D(()=>s("i",{class:"pi pi-search"},null,-1)),ge={class:"flex gap-1 justify-content-center"},he=D(()=>s("div",{class:"text-center py-4"},[s("i",{class:"pi pi-exclamation-circle text-2xl mb-2"}),s("p",{class:"text-xl"},"No records found")],-1)),_e={class:"flex justify-content-center align-items-center py-4"},be={class:"flex align-items-center justify-content-center"},ye=D(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),xe={class:"flex flex-column gap-2 py-1"},we={class:"w-full text-right",for:"rejectReason"},ke={key:0,class:"mt-1 mb-5 text-red-500"},$e={class:"w-full text-center"},Ce={__name:"index",setup(g){const N=Z();ee();const z=l([]),v=l(!0);l({});const k=l(""),B=l(null),$=l(!1),q=l(""),A=l(null),I=l(null),h=l({}),u=l(!1),_=l({}),C=l(!1),j=l(!1);te(()=>{J()});const E=()=>{w.post("/api/users").then(e=>{z.value=e.data.users.data})},b=()=>{v.value=!0,w.get("/api/leaves").then(e=>{v.value=!1,B.value=e.data.data})};ae(()=>{b(),E()});const F=e=>{q.value=e,u.value=!u.value},G=()=>{w.post(`/api/leaves/reject-request/${q.value}`,_.value).then(e=>{b(),u.value=!u.value,N.add({severity:"success",summary:"Successful",detail:"Successful",life:3e3}),_.value=l({})}).catch(e=>{k.value=e.response.data.errors})},W=e=>{v.value=!0,w.get(`/api/leaves/accept-request/${e}`).then(o=>{v.value=!1,b(),N.add({severity:"success",summary:"Successful",detail:"Successful",life:3e3})}).catch(()=>{})},H=()=>{C.value=!0,I.value.exportCSV(),setTimeout(()=>{C.value=!1},1e3)},O=()=>{j.value=!0;const e=document.querySelector(".p-datatable-wrapper").cloneNode(!0);e.querySelectorAll(".p-button").forEach(y=>y.remove());const d=window.open("","_blank");d.document.write(`
    <html>
      <head>
        <title>Leaves Report</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          h1 { color: #333; text-align: center; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          th { background-color: #f5f5f5; text-align: left; padding: 8px; border: 1px solid #ddd; }
          td { padding: 8px; border: 1px solid #ddd; }
          .text-center { text-align: center; }
          .text-right { text-align: right; }
          @page { size: auto; margin: 5mm; }
          @media print {
            body { margin: 0; padding: 0; }
            .no-print { display: none !important; }
          }
        </style>
      </head>
      <body>
        <h1>Leaves Report</h1>
        ${e.innerHTML}
        <div style="text-align: center; margin-top: 20px; font-size: 12px;">
          Generated on ${new Date().toLocaleString()}
        </div>
      </body>
    </html>
  `),d.document.close(),d.focus(),setTimeout(()=>{d.print(),d.close(),j.value=!1},500)},J=()=>{h.value={global:{value:null,matchMode:se.CONTAINS}}};return(e,o)=>{const d=r("Toast"),y=r("InputText"),i=r("Button"),p=r("Column"),K=r("Tag"),Q=r("ProgressSpinner"),X=r("DataTable"),P=r("Dialog"),x=M("can"),L=M("tooltip");return m(),U("div",ie,[s("div",re,[s("div",de,[a(ne),a(d),s("div",ce,[f((m(),R(X,{ref_key:"dt",ref:I,selection:A.value,"onUpdate:selection":o[1]||(o[1]=t=>A.value=t),value:B.value,loading:v.value,"data-key":"id",paginator:!0,rows:10,filters:h.value,"paginator-template":"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown","rows-per-page-options":[5,10,25,50,100],"current-page-report-template":"Showing {first} to {last} of {totalRecords} records","responsive-layout":"scroll",scrollable:"","scroll-height":"flex",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{header:n(()=>[s("div",ue,[s("h3",pe,c(e.$t("Leaves List")),1),s("div",ve,[s("span",me,[fe,a(y,{modelValue:h.value.global.value,"onUpdate:modelValue":o[0]||(o[0]=t=>h.value.global.value=t),placeholder:e.$t("search"),class:"w-full"},null,8,["modelValue","placeholder"])]),f(a(i,{label:e.$t("export"),icon:"pi pi-download",class:"p-button-info no-print",loading:C.value,onClick:H},null,8,["label","loading"]),[[x,"leaves list"]]),a(i,{label:e.$t("print"),icon:"pi pi-print",class:"p-button-help no-print",loading:j.value,onClick:O},null,8,["label","loading"]),f(a(i,{icon:"pi pi-refresh",class:"p-button-text",onClick:b},null,512),[[L,"Refresh data",void 0,{top:!0}]])])])]),empty:n(()=>[he]),loading:n(()=>[s("div",_e,[a(Q,{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:n(()=>[a(p,{"selection-mode":"multiple","header-style":"width: 3rem"}),a(p,{field:"employee.name",header:e.$t("Employee Name"),sortable:!0},{body:n(t=>[T(c(t.data.employee.name),1)]),_:1},8,["header"]),a(p,{field:"reason",header:e.$t("Request Reason"),sortable:!0},{body:n(t=>[T(c(t.data.reason),1)]),_:1},8,["header"]),a(p,{field:"leave_setup.title",header:e.$t("Leave Type"),sortable:!0},{body:n(t=>[T(c(t.data.leave_setup.title),1)]),_:1},8,["header"]),a(p,{field:"status",header:e.$t("Status"),sortable:!0},{body:n(t=>[a(K,{value:t.data.status==0?"Pending":t.data.status==1?"Accepted":"Rejected",severity:t.data.status==0?"warning":t.data.status==1?"success":"danger"},null,8,["value","severity"])]),_:1},8,["header"]),a(p,{exportable:!1,"header-style":"width: 10rem","body-class":"text-center"},{body:n(t=>[s("div",ge,[t.data.status==0?f((m(),R(i,{key:0,icon:"pi pi-times",class:"p-button-rounded p-button-text p-button-danger",onClick:S=>F(t.data.id)},null,8,["onClick"])),[[x,"leaves edit"],[L,"Reject",void 0,{top:!0}]]):V("",!0),t.data.status==0?f((m(),R(i,{key:1,icon:"pi pi-check",class:"p-button-rounded p-button-text p-button-success",onClick:S=>W(t.data.id)},null,8,["onClick"])),[[x,"leaves delete"],[L,"Accept",void 0,{top:!0}]]):V("",!0)])]),_:1})]),_:1},8,["selection","value","loading","filters"])),[[x,"leaves list"]])]),a(P,{visible:$.value,"onUpdate:visible":o[3]||(o[3]=t=>$.value=t),style:{width:"450px"},header:e.$t("confirm"),modal:!0},{footer:n(()=>[a(i,{label:e.$t("no"),icon:"pi pi-times",class:"p-button-text",onClick:o[2]||(o[2]=t=>$.value=!1)},null,8,["label"]),a(i,{label:e.$t("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:e.deleteAction},null,8,["label","onClick"])]),default:n(()=>[s("div",be,[ye,s("span",null,c(e.$t("Are you sure you want to delete this leave request?")),1)])]),_:1},8,["visible","header"]),a(P,{visible:u.value,"onUpdate:visible":o[5]||(o[5]=t=>u.value=t),style:{width:"450px"},header:e.$t("Reject Leave"),modal:!0},{default:n(()=>{var t;return[s("div",xe,[s("label",we,c(e.$t("Rejection Reason")),1),a(y,{required:"",class:"bg-[#f7f5f5] text-center",modelValue:_.value.rejected_reason,"onUpdate:modelValue":o[4]||(o[4]=S=>_.value.rejected_reason=S),placeholder:e.$t("Enter rejection reason")},null,8,["modelValue","placeholder"]),(t=k.value)!=null&&t.rejected_reason?(m(),U("div",ke,c(k.value.rejected_reason[0]),1)):V("",!0)]),s("div",$e,[a(i,{onClick:G,class:"p-button-danger m-auto w-[50%] my-4",label:e.$t("Submit Rejection")},null,8,["label"])])]}),_:1},8,["visible","header"])])])])}}},Se=Y(Ce,[["__scopeId","data-v-8f7e7fc2"]]);export{Se as default};
