import{a9 as O,R as e,aa as z,ah as G,S as H,ab as J,r as s,ac as K,o as m,d as S,e as u,f as l,w as r,i as C,x as T,t as D,F as Q,B as W,h as X,T as Y,c as v}from"./main-2970edd8.js";const Z={class:"grid"},ee={class:"col-12"},te={class:"my-2 grid lg:grid-cols-5 gap-4 grid-cols-1"},ae={style:{},class:"shadow-xl overflow-scroll"},oe={class:"flex w-full justify-between align-items-center"},le={class:"m-0 my-auto"},re={__name:"index",setup(se){const $=O(),f=e([]),i=e(""),_=e([]),c=e(""),g=e([]),n=e([]),x=e(!0),d=e([]);e(!1),e(!1),e("");const h=e(null),p=e(null),b=e({});e(!1),e({}),e(!1),z(()=>{I()});const P=G(()=>g.value.filter(t=>n.value.includes(t.column))),B=()=>{v.get(`/api/report/select-report?lang=${localStorage.getItem("appLang")}`).then(t=>{x.value=!1,f.value=t.data.data,console.log(d.value)})};H(()=>{B()});const N=()=>{v.post(`/api/report/generate-report?lang=${localStorage.getItem("appLang")}`,{model:i.value,columns:n.value,relations:c.value}).then(t=>{d.value=t.data.data})},M=t=>{c.value="",n.value="",d.value="",v.get(`/api/report/select-relations?lang=${localStorage.getItem("appLang")}&model=${t}`).then(a=>{_.value=a.data.data}),v.get(`/api/report/select-columns?lang=${localStorage.getItem("appLang")}&model=${t}`).then(a=>{g.value=a.data.data})},F=()=>{if(d.value.length===0){$.add({severity:"warn",summary:"No Data",detail:"There is no data to export.",life:3e3});return}if(!p.value){console.error("DataTable reference (dt) is not bound.");return}if(typeof p.value.exportCSV!="function"){console.error("exportCSV method is not available on the DataTable.");return}p.value.exportCSV({fileName:"report.csv"})},I=()=>{b.value={global:{value:null,matchMode:J.CONTAINS}}};return(t,a)=>{const R=s("Dropdown"),w=s("MultiSelect"),y=s("Button"),U=s("Toolbar"),q=s("Toast"),k=s("Column"),j=s("DataTable"),A=s("va-card"),V=K("can");return m(),S("div",Z,[u("div",ee,[l(A,{class:"card"},{default:r(()=>[l(U,{class:"mb-4 shadow-md"},{start:r(()=>[u("div",te,[l(R,{"onUpdate:modelValue":[M,a[0]||(a[0]=o=>i.value=o)],modelValue:i.value,required:"",id:"pv_id_1",style:{direction:"ltr !important"},"option-value":"id",options:f.value,optionLabel:"model",placeholder:t.$t("model_id"),class:"w-full bg-[#f7f5f5] [&>div>div>span]:bg-black md:w-14rem"},null,8,["modelValue","options","placeholder"]),l(w,{loading:i.value=="",modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=o=>c.value=o),required:"",id:"pv_id_1",style:{direction:"ltr !important"},"option-value":"relation",options:_.value,optionLabel:"value",placeholder:t.$t("relation_id"),class:"w-full bg-[#f7f5f5] [&>div>div>span]:bg-black md:w-14rem"},null,8,["loading","modelValue","options","placeholder"]),l(w,{loading:i.value=="",modelValue:n.value,"onUpdate:modelValue":a[2]||(a[2]=o=>n.value=o),required:"",id:"pv_id_1",style:{direction:"ltr !important"},"option-value":"column",options:g.value,optionLabel:"value",placeholder:t.$t("columns_id"),class:"w-full bg-[#f7f5f5] [&>div>div>span]:bg-black md:w-14rem"},null,8,["loading","modelValue","options","placeholder"]),l(y,{label:t.$t("search"),class:"create",onClick:N},null,8,["label"])])]),end:r(()=>[]),_:1}),l(q),u("div",ae,[C((m(),T(j,{ref_key:"dt",ref:p,selection:h.value,"onUpdate:selection":a[4]||(a[4]=o=>h.value=o),value:d.value,loading:n.value=="","data-key":"id",paginator:!0,rows:10,filters:b.value,"paginator-template":"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown","rows-per-page-options":[5,10,25],"current-page-report-template":"Showing {first} to {last} of {totalRecords} products","responsive-layout":"scroll"},{header:r(()=>[u("div",oe,[u("h5",le,D(t.$t("reports")),1),C(l(y,{label:t.$t("export"),icon:"pi pi-upload",class:"export",onClick:a[3]||(a[3]=o=>F(o))},null,8,["label"]),[[V,"positions list"]])])]),default:r(()=>[(m(!0),S(Q,null,W(Y(P),(o,L)=>(m(),T(k,{key:L,field:L,header:o.value,sortable:!0,"header-style":"width:14%; min-width:10rem;",class:"ltr:text-justify"},{body:r(E=>[X(D(E.data[o.value]),1)]),_:2},1032,["field","header"]))),128)),l(k,{"header-style":"min-width:10rem;"})]),_:1},8,["selection","value","loading","filters"])),[[V,"positions list"]])])]),_:1})])])}}};export{re as default};
