import{D as pe,o as _,d as f,K as y,J as U,j as Y,e as a,_ as Ae,bG as Pe,a2 as Ve,p as De,l as Ye,q as d,az as z,a3 as Fe,aA as ce,am as Se,t as n,n as q,a4 as s,f as i,g as p,s as O,L as Z,h as ee,T as Me,P as ae,bH as Re,R as te,a as Be,bI as Le,bJ as C,bK as Te,i as Ee,a5 as Ie,c as le,y as Ne,z as Ue}from"./main-1fd4141d.js";import{h as A}from"./moment-fbc5633a.js";var se={name:"Card",extends:pe};function ze(r,$,v,o,c,g){return _(),f("div",y({class:"p-card p-component"},r.ptm("root")),[r.$slots.header?(_(),f("div",y({key:0,class:"p-card-header"},r.ptm("header")),[U(r.$slots,"header")],16)):Y("",!0),a("div",y({class:"p-card-body"},r.ptm("body")),[r.$slots.title?(_(),f("div",y({key:0,class:"p-card-title"},r.ptm("title")),[U(r.$slots,"title")],16)):Y("",!0),r.$slots.subtitle?(_(),f("div",y({key:1,class:"p-card-subtitle"},r.ptm("subtitle")),[U(r.$slots,"subtitle")],16)):Y("",!0),a("div",y({class:"p-card-content"},r.ptm("content")),[U(r.$slots,"content")],16),r.$slots.footer?(_(),f("div",y({key:2,class:"p-card-footer"},r.ptm("footer")),[U(r.$slots,"footer")],16)):Y("",!0)],16)],16)}se.render=ze;var ve={name:"ProgressSpinner",extends:pe,props:{strokeWidth:{type:String,default:"2"},fill:{type:String,default:"none"},animationDuration:{type:String,default:"2s"}},computed:{svgStyle(){return{"animation-duration":this.animationDuration}}}};const Oe=["fill","stroke-width"];function We(r,$,v,o,c,g){return _(),f("div",y({class:"p-progress-spinner",role:"progressbar"},r.ptm("root")),[(_(),f("svg",y({class:"p-progress-spinner-svg",viewBox:"25 25 50 50",style:g.svgStyle},r.ptm("spinner")),[a("circle",y({class:"p-progress-spinner-circle",cx:"50",cy:"50",r:"20",fill:v.fill,"stroke-width":v.strokeWidth,strokeMiterlimit:"10"},r.ptm("circle")),null,16,Oe)],16))],16)}function He(r,$){$===void 0&&($={});var v=$.insertAt;if(!(!r||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",v==="top"&&o.firstChild?o.insertBefore(c,o.firstChild):o.appendChild(c),c.styleSheet?c.styleSheet.cssText=r:c.appendChild(document.createTextNode(r))}}var je=`
.p-progress-spinner {
    position: relative;
    margin: 0 auto;
    width: 100px;
    height: 100px;
    display: inline-block;
}
.p-progress-spinner::before {
    content: '';
    display: block;
    padding-top: 100%;
}
.p-progress-spinner-svg {
    height: 100%;
    transform-origin: center center;
    width: 100%;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    margin: auto;
}
`;He(je);ve.render=We;const B=r=>(Ne("data-v-253cc5fd"),r=r(),Ue(),r),qe={class:"evaluation-results-container"},xe={class:"header-section"},Je={key:0,class:"page-title"},Ke={class:"child-name"},Ge={class:"profile-name"},Qe={class:"evaluation-title"},Xe=B(()=>a("i",{class:"pi pi-arrow-left"},null,-1)),Ze={class:"button-text"},ea={class:"chart-controls"},aa={class:"chart-type-selector"},ta={class:"axis-selectors"},la={class:"axis-selector"},sa={class:"p-float-label"},oa={class:"axis-selector"},ra={class:"p-float-label"},ia={class:"chart-title"},na=B(()=>a("i",{class:"pi pi-chart-bar"},null,-1)),da={class:"chart-container"},ua={key:1,class:"no-results"},ca=B(()=>a("i",{class:"pi pi-info-circle"},null,-1)),pa={class:"flex gap-4 pb-2"},va={class:""},ha={class:""},_a={class:""},fa={class:""},ga={class:"results-header"},ma={class:"results-title"},ba=B(()=>a("i",{class:"pi pi-table"},null,-1)),ya={class:"results-actions"},$a={class:"p-input-icon-left search-box"},wa=B(()=>a("i",{class:"pi pi-search"},null,-1)),Ca=B(()=>a("i",{class:"pi pi-print"},null,-1)),ka={class:"button-text"},Aa={key:0,class:"loading-overlay"},Pa={class:"loading-text"},Va={class:"index-badge"},Da={class:"age-value"},Ya={class:"unit"},Fa={class:"value-badge"},Sa={class:"value-badge"},Ma={class:"age-value"},Ra={class:"unit"},Ba={class:"percentage-container"},La={class:"percentage-value"},Ta={class:"date-value"},Ea={class:"edit-form"},Ia={class:"field"},Na={class:"p-float-label"},Ua={key:0,class:"p-error"},za={class:"form-actions"},Oa={__name:"ChildResult",setup(r){Pe(e=>({"3895e62c":s(c)==="ar"?"rtl":"ltr"}));const $=Ve(),v=De(),{t:o,locale:c}=Ye(),g=d([]),L=d(null),oe=d("success"),F=d([]),P=d([]),T=d([]),E=d([]),m=d(null),b=d(null),u=d("bar"),k=d("createdAt"),w=d("latePercentage"),x=d({}),J=d({}),W=d(""),re=d({global:{value:null,matchMode:"contains"}}),S=d(!1),V=d(null),ie=d(""),H=d(!0),K=d(""),j=d(!1),he=z(()=>[{label:o("bar_chart"),value:"bar"},{label:o("line_chart"),value:"line"},{label:o("pie_chart"),value:"pie"},{label:o("doughnut_chart"),value:"doughnut"},{label:o("polar_area_chart"),value:"polarArea"},{label:o("radar_chart"),value:"radar"}]),ne=z(()=>[{title:o("created_at"),value:"createdAt"},{title:o("grow_age"),value:"growAge"},{title:o("diff_age"),value:"diffAge"},{title:o("late_percentage"),value:"latePercentage"}]),_e=z(()=>ne.value.filter(e=>e.value!==w.value)),fe=z(()=>ne.value.filter(e=>e.value!==k.value)),ge=z(()=>W.value?g.value.filter(e=>Object.keys(e).some(l=>String(e[l]).toLowerCase().includes(W.value.toLowerCase()))):g.value),de=()=>{const e=getComputedStyle(document.documentElement);if(["pie","doughnut","polarArea"].includes(u.value))return{labels:F.value,datasets:[{data:P.value.map(h=>h??0),backgroundColor:["#66BB6A","#EF5350","#42A5F5","#FFCA28","#AB47BC","#26A69A"],borderColor:e.getPropertyValue("--surface-border"),borderWidth:1}]};if(k.value&&w.value){const h={growAge:T.value,diffAge:E.value,latePercentage:P.value,createdAt:F.value},t={growAge:T.value,diffAge:E.value,latePercentage:P.value},I=h[k.value]||F.value,X=t[w.value]||P.value,M=I.map((R,N)=>({x:R??0,y:X[N]??0}));return{labels:I,datasets:[{label:o(w.value),data:M,backgroundColor:"#42A5F5",borderColor:"#1565C0",pointRadius:u.value==="scatter"?5:0,pointHoverRadius:7,showLine:u.value==="line"||u.value==="radar",fill:u.value==="line"||u.value==="radar",tension:.3}]}}return{labels:F.value,datasets:[{label:o("late_percentage"),backgroundColor:"#66BB6A",borderColor:"#388E3C",data:P.value.map(h=>h??0),fill:u.value==="line"||u.value==="radar",tension:.3},{label:o("diff_age"),backgroundColor:"#EF5350",borderColor:"#D32F2F",data:E.value.map(h=>h??0),fill:u.value==="line"||u.value==="radar",tension:.3},{label:o("grow_age"),backgroundColor:"#42A5F5",borderColor:"#1565C0",data:T.value.map(h=>h??0),fill:u.value==="line"||u.value==="radar",tension:.3}]}},ue=()=>{const e=getComputedStyle(document.documentElement),l=e.getPropertyValue("--text-color"),h=e.getPropertyValue("--text-color-secondary"),t=e.getPropertyValue("--surface-border"),I=k.value?o(k.value):o("created_at"),X=w.value?o(w.value):o("values"),M={maintainAspectRatio:!1,aspectRatio:.8,plugins:{legend:{labels:{color:l,font:{weight:"bold"}}},tooltip:{backgroundColor:"#424242",titleColor:"#FFFFFF",bodyColor:"#FFFFFF",borderColor:t,borderWidth:1,padding:12,boxPadding:6,displayColors:!0,usePointStyle:!0,callbacks:{label:function(R){let N=R.dataset.label||"";N&&(N+=": ");const ke=R.parsed.y!==void 0?R.parsed.y:R.parsed;return`${N}${ke}`}}}},scales:{x:{ticks:{color:h,font:{weight:"bold"}},grid:{color:t,drawBorder:!1},title:{display:!0,text:I,color:l,font:{size:14,weight:"bold"}}},y:{ticks:{color:h,font:{weight:"bold"}},grid:{color:t,drawBorder:!1},title:{display:!0,text:X,color:l,font:{size:14,weight:"bold"}}}},animation:{duration:1e3,easing:"easeInOutQuad"},elements:{point:{radius:4,hoverRadius:6,borderWidth:2},line:{tension:.3,borderWidth:2},bar:{borderRadius:6,borderWidth:0,borderSkipped:!1}}};return["pie","doughnut","polarArea","radar"].includes(u.value)&&(delete M.scales,u.value==="polarArea"&&(M.scale={ticks:{display:!1},grid:{circular:!0}}),u.value==="radar"&&(M.scales={r:{angleLines:{display:!0,color:t},suggestedMin:0,ticks:{display:!1},grid:{circular:!0,color:t}}})),M},G=async()=>{try{H.value=!0;const e=await le.post(`/api/evaluations/${v.params.child_id}/${v.params.sideProfile_id}/${v.params.evaluation_id}/result`,{date1:m.value?A(m.value).format("YYYY-MM-DD"):"",date2:b.value?A(b.value).format("YYYY-MM-DD"):""});g.value=e.data.resultEvaluation,F.value=[],P.value=[],T.value=[],E.value=[],g.value.forEach(l=>{F.value.push(A(l.result_created_at).format("MM-DD-YYYY")),P.value.push(parseFloat(l.late_percentage)||0),T.value.push(parseInt(l.grow_age)||0),E.value.push(parseInt(l.diff_age)||0)}),x.value=de(),J.value=ue()}catch(e){console.error("Error fetching results:",e),D(o("failed_to_fetch_results"),"error")}finally{H.value=!1}},me=async()=>{try{const e=await le.get(`/api/side-profiles/${v.params.sideProfile_id}`);K.value=e.data.sideProfile.title}catch(e){console.error("Error fetching side profile:",e),D(o("failed_to_fetch_side_profile"),"error")}},Q=async()=>{if(m.value&&b.value&&A(b.value).isBefore(m.value)){D(o("invalid_date_range"),"error");return}try{await G()}catch(e){console.error("Error filtering results:",e),D(o("failed_to_filter_results"),"error")}},be=e=>A(e).locale(c.value).format("DD-MM-YYYY HH:mm"),ye=()=>{m.value&&b.value?$.push({name:"printChildResult",params:{child_id:v.params.child_id,sideProfile_id:v.params.sideProfile_id,evaluation_id:v.params.evaluation_id,start:A(m.value).format("YYYY-MM-DD"),end:A(b.value).format("YYYY-MM-DD")}}):$.push({name:"printChildResultfilter",params:{child_id:v.params.child_id,sideProfile_id:v.params.sideProfile_id,evaluation_id:v.params.evaluation_id}})},$e=(e,l)=>{S.value=!0,V.value=new Date(e),ie.value=l,j.value=!1},we=async()=>{var e,l;if(j.value=!0,!V.value){D(o("date_required"),"error");return}try{await le.post(`/api/evaluations/${ie.value}`,{date:A(V.value).format("YYYY-MM-DD")}),D(o("evaluation_edited_successfully"),"success"),S.value=!1,await G()}catch(h){D(((l=(e=h.response)==null?void 0:e.data)==null?void 0:l.message)||o("failed_to_edit_evaluation"),"error"),S.value=!1}},D=(e,l)=>{L.value=e,oe.value=l,setTimeout(()=>{L.value=null},5e3)},Ce=()=>{$.go(-1)};return Fe(async()=>{await Promise.all([G(),me()])}),ce([u,k,w,c],()=>{x.value=de(),J.value=ue()}),ce([m,b],()=>{(m.value||b.value)&&Q()}),(e,l)=>{const h=Se("tooltip");return _(),f("div",qe,[a("div",xe,[g.value[0]&&K.value?(_(),f("div",Je,[a("span",Ke,n(g.value[0].child_name),1),a("span",{class:q(["separator",s(c)])},n(s(c)==="en"?"/":"\\"),3),a("span",Ge,n(K.value),1),a("span",{class:q(["separator",s(c)])},n(s(c)==="en"?"/":"\\"),3),a("span",Qe,n(g.value[0].evaluation_title),1)])):Y("",!0),i(s(O),{class:"back-button",severity:"primary",onClick:Ce,rounded:"",outlined:""},{default:p(()=>[Xe,a("span",Ze,n(e.$t("back")),1)]),_:1})]),L.value?(_(),Z(s(Me),{key:0,severity:oe.value,class:"alert-message",onClose:l[0]||(l[0]=t=>L.value=null)},{default:p(()=>[ee(n(L.value),1)]),_:1},8,["severity"])):Y("",!0),a("div",ea,[a("div",aa,[i(s(ae),{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=t=>u.value=t),options:s(he),optionLabel:"label",optionValue:"value",placeholder:e.$t("select_chart_type"),class:"chart-dropdown",pt:{root:{class:"dropdown-root"},input:{class:"dropdown-input"},panel:{class:"dropdown-panel"}}},null,8,["modelValue","options","placeholder"])]),a("div",ta,[a("div",la,[a("span",sa,[i(s(ae),{modelValue:k.value,"onUpdate:modelValue":l[2]||(l[2]=t=>k.value=t),options:s(_e),optionLabel:"title",optionValue:"value",placeholder:e.$t("xAxis"),class:"chart-dropdown",pt:{root:{class:"dropdown-root"},input:{class:"dropdown-input"},panel:{class:"dropdown-panel"}}},null,8,["modelValue","options","placeholder"]),a("label",null,n(e.$t("xAxis")),1)])]),a("div",oa,[a("span",ra,[i(s(ae),{modelValue:w.value,"onUpdate:modelValue":l[3]||(l[3]=t=>w.value=t),options:s(fe),optionLabel:"title",optionValue:"value",placeholder:e.$t("yAxis"),class:"chart-dropdown",pt:{root:{class:"dropdown-root"},input:{class:"dropdown-input"},panel:{class:"dropdown-panel"}}},null,8,["modelValue","options","placeholder"]),a("label",null,n(e.$t("yAxis")),1)])])])]),i(s(se),{class:"chart-card"},{title:p(()=>[a("div",ia,[na,a("span",null,n(e.$t("evaluation_results_visualization")),1)])]),content:p(()=>[a("div",da,[g.value.length>0?(_(),Z(s(Re),{key:0,type:u.value,data:x.value,options:J.value,class:"main-chart","aria-label":e.$t("evaluation_results_chart")},null,8,["type","data","options","aria-label"])):(_(),f("div",ua,[ca,a("span",null,n(e.$t("no_data_available")),1)]))])]),_:1}),a("div",null,[a("div",pa,[a("div",va,[a("span",ha,[i(s(te),{modelValue:m.value,"onUpdate:modelValue":[l[4]||(l[4]=t=>m.value=t),Q],dateFormat:"dd/mm/yy",placeholder:e.$t("from"),class:"date-picker"},null,8,["modelValue","placeholder"])])]),a("div",_a,[a("span",fa,[i(s(te),{modelValue:b.value,"onUpdate:modelValue":[l[5]||(l[5]=t=>b.value=t),Q],dateFormat:"dd/mm/yy",placeholder:e.$t("to"),class:"date-picker"},null,8,["modelValue","placeholder"])])])])]),i(s(se),{class:"results-card"},{title:p(()=>[a("div",ga,[a("div",ma,[ba,a("span",null,n(e.$t("evaluation_results")),1)]),a("div",ya,[a("span",$a,[wa,i(s(Be),{modelValue:W.value,"onUpdate:modelValue":l[6]||(l[6]=t=>W.value=t),placeholder:e.$t("search"),class:"search-input"},null,8,["modelValue","placeholder"])]),i(s(O),{severity:"success",onClick:ye,class:"print-button",outlined:"",rounded:""},{default:p(()=>[Ca,a("span",ka,n(e.$t("print")),1)]),_:1})])])]),content:p(()=>[H.value?(_(),f("div",Aa,[i(s(ve)),a("span",Pa,n(e.$t("loading")),1)])):(_(),Z(s(Le),{key:1,value:s(ge),paginator:!0,rows:10,rowsPerPageOptions:[5,10,25,50],loading:H.value,globalFilterFields:["therapist_name","child_age","grow_age","diff_age","basal_age","late_percentage","result_created_at"],filters:re.value,"onUpdate:filters":l[7]||(l[7]=t=>re.value=t),class:"results-table",stripedRows:"",removableSort:"",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown"},{default:p(()=>[i(s(C),{field:"id",header:e.$t("id"),sortable:!0,class:"id-column"},{body:p(({index:t})=>[a("span",Va,n(t+1),1)]),_:1},8,["header"]),i(s(C),{field:"therapist_name",header:e.$t("therapist_name"),sortable:!0,class:"therapist-column"},null,8,["header"]),i(s(C),{field:"child_age",header:e.$t("child_age"),sortable:!0,class:"age-column"},{body:p(({data:t})=>[a("span",Da,[ee(n(t.child_age)+" ",1),a("span",Ya,n(e.$t("months")),1)])]),_:1},8,["header"]),i(s(C),{field:"grow_age",header:e.$t("grow_age"),sortable:!0,class:"grow-column"},{body:p(({data:t})=>[a("span",Fa,n(t.grow_age),1)]),_:1},8,["header"]),i(s(C),{field:"diff_age",header:e.$t("diff_age"),sortable:!0,class:"diff-column"},{body:p(({data:t})=>[a("span",Sa,n(t.diff_age),1)]),_:1},8,["header"]),i(s(C),{field:"basal_age",header:e.$t("basal_age"),sortable:!0,class:"basal-column"},{body:p(({data:t})=>[a("span",Ma,[ee(n(t.basal_age||"N/A")+" ",1),a("span",Ra,n(e.$t("months")),1)])]),_:1},8,["header"]),i(s(C),{field:"late_percentage",header:e.$t("late_percentage"),sortable:!0,class:"percentage-column"},{body:p(({data:t})=>[a("div",Ba,[a("span",La,n(Math.round(t.late_percentage))+"%",1),i(s(Te),{value:Math.round(t.late_percentage),showValue:!1,class:q(["percentage-bar",{low:Math.round(t.late_percentage)<30,medium:Math.round(t.late_percentage)>=30&&Math.round(t.late_percentage)<70,high:Math.round(t.late_percentage)>=70}])},null,8,["value","class"])])]),_:1},8,["header"]),i(s(C),{field:"result_created_at",header:e.$t("created_at"),sortable:!0,class:"date-column"},{body:p(({data:t})=>[a("span",Ta,n(be(t.result_created_at)),1)]),_:1},8,["header"]),i(s(C),{header:e.$t("operation"),class:"action-column"},{body:p(({data:t})=>[Ee(i(s(O),{icon:"pi pi-pencil",severity:"info",text:"",rounded:"",onClick:I=>$e(t.result_created_at,t.id),class:"edit-button"},null,8,["onClick"]),[[h,e.$t("edit_evaluation"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","filters"]))]),_:1}),i(s(Ie),{visible:S.value,"onUpdate:visible":l[10]||(l[10]=t=>S.value=t),modal:"",header:e.$t("edit_evaluation_date"),class:"edit-dialog",style:{width:"450px"}},{default:p(()=>[a("div",Ea,[a("div",Ia,[a("span",Na,[i(s(te),{modelValue:V.value,"onUpdate:modelValue":l[8]||(l[8]=t=>V.value=t),dateFormat:"dd/mm/yy",showIcon:"",class:q(["edit-date-picker",{"p-invalid":j.value&&!V.value}])},null,8,["modelValue","class"]),a("label",null,n(e.$t("evaluation_date")),1)]),j.value&&!V.value?(_(),f("small",Ua,n(e.$t("date_required")),1)):Y("",!0)]),a("div",za,[i(s(O),{label:e.$t("cancel"),severity:"secondary",onClick:l[9]||(l[9]=t=>S.value=!1),class:"cancel-button",outlined:""},null,8,["label"]),i(s(O),{label:e.$t("save"),severity:"primary",onClick:we,class:"submit-button"},null,8,["label"])])])]),_:1},8,["visible","header"])])}}},ja=Ae(Oa,[["__scopeId","data-v-253cc5fd"]]);export{ja as default};
