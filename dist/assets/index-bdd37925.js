import{m as G,q as a,aj as H,ay as J,a2 as K,ak as Q,r as s,al as W,o as h,d as C,e as p,f as o,g as r,i as $,L as D,t as T,F as X,x as Y,h as Z,a3 as ee,c as m}from"./main-07c0fdcf.js";const te={class:"grid"},ae={class:"col-12"},le={class:"my-2 grid md:grid-cols-5 gap-4 grid-cols-1"},oe={style:{},class:"shadow-xl overflow-scroll"},se={class:"flex w-full justify-between align-items-center"},ne={class:"m-0 my-auto"},de={__name:"index",setup(re){const P=G(),b=a([]),v=a(""),g=a(6),w=a([]),i=a(""),n=a([]),d=a([]),N=a(!0),c=a([]);a(!1),a(!1),a("");const L=a(null),f=a(null),y=a({});a(!1),a({}),a(!1),H(()=>{U()});const B=J(()=>n.value.filter(t=>d.value.includes(t.column))),M=()=>{m.get(`/api/report/select-report?lang=${localStorage.getItem("appLang")}`).then(t=>{N.value=!1,b.value=t.data.data,console.log(c.value)})};K(()=>{M()});const I=()=>{const t=[];i.value.forEach(e=>{t.push(e.relation)}),m.post(`/api/report/generate-report?lang=${localStorage.getItem("appLang")}`,{model:v.value,columns:n.value,relations:t}).then(e=>{c.value=e.data.data})},F=t=>{const e=[];t.forEach(u=>{e.push(u.id)}),m.get(`/api/report/select-columns?lang=${localStorage.getItem("appLang")}&model=${e}`).then(u=>{u.data.data.forEach(_=>{n.value.push(_)})})},q=t=>{i.value="",d.value="",n.value="",c.value="",m.get(`/api/report/select-relations?lang=${localStorage.getItem("appLang")}&model=${t}`).then(e=>{w.value=e.data.data}),m.get(`/api/report/select-columns?lang=${localStorage.getItem("appLang")}&model=${t}`).then(e=>{n.value=e.data.data})},E=()=>{if(c.value.length===0){P.add({severity:"warn",summary:"No Data",detail:"There is no data to export.",life:3e3});return}if(!f.value){console.error("DataTable reference (dt) is not bound.");return}if(typeof f.value.exportCSV!="function"){console.error("exportCSV method is not available on the DataTable.");return}f.value.exportCSV({fileName:"report.csv"})},U=()=>{y.value={global:{value:null,matchMode:Q.CONTAINS}}};return(t,e)=>{const u=s("Dropdown"),_=s("MultiSelect"),S=s("Button"),j=s("Toolbar"),R=s("Toast"),k=s("Column"),A=s("DataTable"),O=s("va-card"),x=W("can");return h(),C("div",te,[p("div",ae,[o(O,{class:"card"},{default:r(()=>[o(j,{class:"mb-4 shadow-md"},{start:r(()=>[p("div",le,[o(u,{"onUpdate:modelValue":[q,e[0]||(e[0]=l=>v.value=l)],modelValue:v.value,required:"",id:"pv_id_1",style:{direction:"ltr !important"},"option-value":"id",options:b.value,optionLabel:"model",placeholder:t.$t("model_id"),class:"w-full bg-[#f7f5f5] [&>div>div>span]:bg-black md:w-14rem"},null,8,["modelValue","options","placeholder"]),o(_,{maxSelectedLabels:g.value,selectionLimit:g.value,"onUpdate:modelValue":[F,e[1]||(e[1]=l=>i.value=l)],loading:v.value=="",modelValue:i.value,required:"",id:"pv_id_1",style:{direction:"ltr !important"},options:w.value,optionLabel:"value",placeholder:t.$t("relation_id"),class:"w-full bg-[#f7f5f5] [&>div>div>span]:bg-black md:w-14rem"},null,8,["maxSelectedLabels","selectionLimit","loading","modelValue","options","placeholder"]),o(_,{maxSelectedLabels:g.value,selectionLimit:g.value,loading:i.value=="",modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=l=>d.value=l),required:"",id:"pv_id_1",style:{direction:"ltr !important"},"option-value":"column",options:n.value,optionLabel:"value",placeholder:t.$t("columns_id"),class:"w-full bg-[#f7f5f5] [&>div>div>span]:bg-black md:w-14rem"},null,8,["maxSelectedLabels","selectionLimit","loading","modelValue","options","placeholder"]),o(S,{label:t.$t("search"),class:"create",onClick:I},null,8,["label"])])]),end:r(()=>[]),_:1}),o(R),p("div",oe,[$((h(),D(A,{ref_key:"dt",ref:f,selection:L.value,"onUpdate:selection":e[4]||(e[4]=l=>L.value=l),value:c.value,loading:d.value=="","data-key":"id",paginator:!0,rows:10,filters:y.value,"paginator-template":"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown","rows-per-page-options":[5,10,25],"current-page-report-template":"Showing {first} to {last} of {totalRecords} products","responsive-layout":"scroll"},{header:r(()=>[p("div",se,[p("h5",ne,T(t.$t("reports")),1),$(o(S,{label:t.$t("export"),icon:"pi pi-upload",class:"export",onClick:e[3]||(e[3]=l=>E(l))},null,8,["label"]),[[x,"positions list"]])])]),default:r(()=>[(h(!0),C(X,null,Y(ee(B),(l,V)=>(h(),D(k,{key:V,field:V,header:l.value,sortable:!0,"header-style":"width:14%; min-width:10rem;",class:"ltr:text-justify"},{body:r(z=>[Z(T(z.data[l.value]),1)]),_:2},1032,["field","header"]))),128)),o(k,{"header-style":"min-width:10rem;"})]),_:1},8,["selection","value","loading","filters"])),[[x,"positions list"]])])]),_:1})])])}}};export{de as default};
