import{m as z,q as a,ah as G,at as H,a0 as J,ai as K,r as s,aj as Q,o as h,d as S,e as p,f as l,g as r,i as $,L as D,t as T,F as W,x as X,h as Y,a1 as Z,c as m}from"./main-8a504821.js";const ee={class:"grid"},te={class:"col-12"},ae={class:"my-2 grid md:grid-cols-5 gap-4 grid-cols-1"},oe={style:{},class:"shadow-xl overflow-scroll"},le={class:"flex w-full justify-between align-items-center"},se={class:"m-0 my-auto"},ie={__name:"index",setup(ne){const x=z(),_=a([]),v=a(""),b=a([]),i=a(""),n=a([]),d=a([]),P=a(!0),u=a([]);a(!1),a(!1),a("");const w=a(null),g=a(null),y=a({});a(!1),a({}),a(!1),G(()=>{E()});const N=H(()=>n.value.filter(t=>d.value.includes(t.column))),B=()=>{m.get(`/api/report/select-report?lang=${localStorage.getItem("appLang")}`).then(t=>{P.value=!1,_.value=t.data.data,console.log(u.value)})};J(()=>{B()});const M=()=>{const t=[];i.value.forEach(e=>{t.push(e.relation)}),m.post(`/api/report/generate-report?lang=${localStorage.getItem("appLang")}`,{model:v.value,columns:n.value,relations:t}).then(e=>{u.value=e.data.data})},I=t=>{const e=[];t.forEach(c=>{e.push(c.id)}),m.get(`/api/report/select-columns?lang=${localStorage.getItem("appLang")}&model=${e}`).then(c=>{c.data.data.forEach(f=>{n.value.push(f)})})},F=t=>{i.value="",d.value="",n.value="",u.value="",m.get(`/api/report/select-relations?lang=${localStorage.getItem("appLang")}&model=${t}`).then(e=>{b.value=e.data.data}),m.get(`/api/report/select-columns?lang=${localStorage.getItem("appLang")}&model=${t}`).then(e=>{n.value=e.data.data})},q=()=>{if(u.value.length===0){x.add({severity:"warn",summary:"No Data",detail:"There is no data to export.",life:3e3});return}if(!g.value){console.error("DataTable reference (dt) is not bound.");return}if(typeof g.value.exportCSV!="function"){console.error("exportCSV method is not available on the DataTable.");return}g.value.exportCSV({fileName:"report.csv"})},E=()=>{y.value={global:{value:null,matchMode:K.CONTAINS}}};return(t,e)=>{const c=s("Dropdown"),f=s("MultiSelect"),k=s("Button"),U=s("Toolbar"),j=s("Toast"),L=s("Column"),R=s("DataTable"),A=s("va-card"),V=Q("can");return h(),S("div",ee,[p("div",te,[l(A,{class:"card"},{default:r(()=>[l(U,{class:"mb-4 shadow-md"},{start:r(()=>[p("div",ae,[l(c,{"onUpdate:modelValue":[F,e[0]||(e[0]=o=>v.value=o)],modelValue:v.value,required:"",id:"pv_id_1",style:{direction:"ltr !important"},"option-value":"id",options:_.value,optionLabel:"model",placeholder:t.$t("model_id"),class:"w-full bg-[#f7f5f5] [&>div>div>span]:bg-black md:w-14rem"},null,8,["modelValue","options","placeholder"]),l(f,{"onUpdate:modelValue":[I,e[1]||(e[1]=o=>i.value=o)],loading:v.value=="",modelValue:i.value,required:"",id:"pv_id_1",style:{direction:"ltr !important"},options:b.value,optionLabel:"value",placeholder:t.$t("relation_id"),class:"w-full bg-[#f7f5f5] [&>div>div>span]:bg-black md:w-14rem"},null,8,["loading","modelValue","options","placeholder"]),l(f,{loading:i.value=="",modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=o=>d.value=o),required:"",id:"pv_id_1",style:{direction:"ltr !important"},"option-value":"column",options:n.value,optionLabel:"value",placeholder:t.$t("columns_id"),class:"w-full bg-[#f7f5f5] [&>div>div>span]:bg-black md:w-14rem"},null,8,["loading","modelValue","options","placeholder"]),l(k,{label:t.$t("search"),class:"create",onClick:M},null,8,["label"])])]),end:r(()=>[]),_:1}),l(j),p("div",oe,[$((h(),D(R,{ref_key:"dt",ref:g,selection:w.value,"onUpdate:selection":e[4]||(e[4]=o=>w.value=o),value:u.value,loading:d.value=="","data-key":"id",paginator:!0,rows:10,filters:y.value,"paginator-template":"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown","rows-per-page-options":[5,10,25],"current-page-report-template":"Showing {first} to {last} of {totalRecords} products","responsive-layout":"scroll"},{header:r(()=>[p("div",le,[p("h5",se,T(t.$t("reports")),1),$(l(k,{label:t.$t("export"),icon:"pi pi-upload",class:"export",onClick:e[3]||(e[3]=o=>q(o))},null,8,["label"]),[[V,"positions list"]])])]),default:r(()=>[(h(!0),S(W,null,X(Z(N),(o,C)=>(h(),D(L,{key:C,field:C,header:o.value,sortable:!0,"header-style":"width:14%; min-width:10rem;",class:"ltr:text-justify"},{body:r(O=>[Y(T(O.data[o.value]),1)]),_:2},1032,["field","header"]))),128)),l(L,{"header-style":"min-width:10rem;"})]),_:1},8,["selection","value","loading","filters"])),[[V,"positions list"]])])]),_:1})])])}}};export{ie as default};
