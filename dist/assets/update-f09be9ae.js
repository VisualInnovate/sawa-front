import{_ as w,P as k,m as D,bu as T,c as n,r as p,o as m,d as u,e as a,t as i,f as o,g as F,n as c,F as x,x as S,j as g,w as L,a5 as E}from"./main-ecd549ee.js";import{F as P,i as U,a as N,b as B,c as A,l as f}from"./index-564cab05.js";import"./moment-fbc5633a.js";import{V as G}from"./VTextarea-61760e58.js";const I={components:{FullCalendar:P,Calendar:k},data(){return{doctors:{},admin_id:"",deleteDialog:!1,submitted:!1,setiontype:"",programes:{},child:{},rooms:{},error:{},doctors:{},isSubmitting:!1,programe_type:{},toast:D(),student:{time_slots:[]},capasityboj:{},capasity:[],maxcapsity:"",treaments:{},time_slotename:[],buttomaddcal:!0,timeshow:!1,FullCalendarshow:!1,langStore:T(),opts:{plugins:[U,N,B,A],initialView:"dayGridMonth",footerToolbar:!0,valid:!1,buttonIcons:!1,locale:null,validRange:{start:new Date},selectable:!1,droppable:!1,editable:!0,selectHelper:!0,validRange:{start:new Date},headerToolbar:{center:"prev next today",left:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},eventsTimeFormat:{hour:"2-digit",minute:"2-digit",second:"2-digit"},eventClick:(function(t){this.student.time_slots.some(e=>e.time_slot_id==t.event.id)?(t.event.setProp("backgroundColor","blue"),this.student.time_slots.splice(this.student.time_slots.findIndex(e=>e.time_slot_id==t.event.id),1)):(t.event.setProp("backgroundColor","green"),this.student.time_slots.push({time_slot_id:t.event.id})),console.log(this.student.time_slots)}).bind(this)}}},methods:{deleteitem(t){this.capasity.splice(t,1)},getAllDocto(){n.get("api/doctors").then(t=>{this.doctors=t.data.doctors,console.log(this.doctors)}).catch(t=>{console.error("Error retrieving doctors:",t)})},deletearray(){this.capasity.length=[],this.maxcapsity=this.refmaxcapsity},addarray(){this.capasity.push({treatment_id:this.student.Type,sessions_number:this.student.sessions_number,name:this.treaments.find(t=>t.id==this.student.Type).name}),this.maxcapsity=this.maxcapsity-this.student.sessions_number,this.student.sessions_number=""},getprograme(t){this.capasity=[],this.student.sessions_number="",n.get(`/api/program/${this.student.program_id}`).then(e=>{this.refmaxcapsity=e.data.data.individual_sessions,this.maxcapsity=e.data.data.individual_sessions,this.setiontype=e.data.data.session_type}),n.get(`api/slot/filter/${t}`).then(e=>{this.opts.events=e.data.data.map(r=>({title:r.title,start:r.start,end:r.end,id:r.id,from:r.from}))})},getalltreatement(){n.get("api/treatment/all").then(t=>{this.treaments=t.data.data,this.getOne(),console.log(this.doctors)})},getallchild(){n.get("api/child").then(t=>{this.child=t.data.children})},getOne(){n.get(`api/student-program/${this.$route.params.id}`).then(t=>{this.student.student_id=t.data.data.student_id,this.student.program_id=t.data.data.program_id,this.student.recommendations=t.data.data.recommendations,this.maxcapsity=t.data.data.program.individual_sessions,t.data.data.student_program_details.forEach(e=>{this.maxcapsity=this.maxcapsity-e.sessions_number}),this.capasity=t.data.data.student_program_details.map(e=>({treatment_id:e.treatment_id,sessions_number:e.sessions_number,name:e.treatment.name})),this.opts.events=t.data.data.time_slots.map(e=>({title:e.title,start:e.start,end:e.end,id:e.id,from:e.from}))})},getallprogrames(){n.get("api/program").then(t=>{this.programes=t.data.data})},updatePrograme(){n.put(`/api/student-program/${this.$route.params.id}`,{program_id:this.student.program_id,student_id:this.student.student_id,details:this.capasity,time_slots:this.student.time_slots,shared_slots:this.maxcapsity}).then(t=>{this.$toast.add({severity:"success",summary:this.$t("success_message"),detail:`${this.$t("element_add_success")}`,life:3e3})}).catch(t=>{this.$toast.add({severity:"error",summary:this.$t("error"),detail:`${t.response.data.message}`,life:3e3})})},highlightSelectedDay(t){this.$store.state.calendar.selectedDay===t.dateStr&&t.el.classList.add("selected-day")},loo(){localStorage.appLang=="en"?console.log("ascasc"):this.opts.locale=f},refreshEvents(){this.$refs.calendar.$emit("refetch-events")}},mounted(){this.getallprogrames(),this.getallchild(),this.getalltreatement(),localStorage.appLang=="en"?console.log("ascasc"):this.opts.locale=f},watch:{"langStore.appLang"(t){t=="en"?this.opts.locale="":this.opts.locale=f}}},R={class:"text-xl p-4 text-[#135C65] cursor-pointer font-bold"},j={class:"p-[2%] bg-[#FDFDFD] grid grid-cols-1 lg:grid-cols-2 gap-4"},q={class:"flex flex-column gap-2"},M={for:"username"},O={class:"flex flex-column gap-2"},W={for:"username"},z={class:"flex flex-column gap-2"},H={class:"w-full text-right",for:"username"},J=a("th",null," عدد الجسات الفردية + الجماعية ",-1),K={key:0},Q={class:"px-4"},X={key:0,class:"mt-1 mb-5 text-red-500"},Y=a("div",{class:"card flex justify-content-center"},null,-1),Z={class:"flex flex-column gap-2 w-full"};function $(t,e,r,tt,s,d){const h=p("Dropdown"),_=p("Button"),v=p("InputNumber"),V=p("Toast"),C=p("FullCalendar");return m(),u(x,null,[a("div",null,[a("div",null,[a("p",R,i(t.$t("add_sp")),1)])]),o(E,null,{default:F(()=>{var y;return[a("form",{onSubmit:e[7]||(e[7]=L((...l)=>d.updatePrograme&&d.updatePrograme(...l),["prevent"]))},[a("div",j,[a("div",q,[a("label",M,i(t.$t("ProgramName")),1),o(h,{required:"",id:"pv_id_1",style:{direction:"ltr !important"},modelValue:s.student.program_id,"onUpdate:modelValue":[e[0]||(e[0]=l=>s.student.program_id=l),d.getprograme],"option-value":"id",filter:"",options:s.programes,optionLabel:"name",class:c({"p-invalid":s.submitted&&!s.student.program_id})},null,8,["modelValue","onUpdate:modelValue","options","class"])]),a("div",O,[a("label",W,i(t.$t("child_name")),1),o(h,{required:"",id:"pv_id_1",style:{direction:"ltr !important"},modelValue:s.student.student_id,"onUpdate:modelValue":[e[1]||(e[1]=l=>s.student.student_id=l),t.getAllDoctor],"option-value":"id",filter:"",options:s.child,optionLabel:"name",placeholder:t.$t("child_name"),class:c({"p-invalid":s.submitted&&!s.student.student_id})},null,8,["modelValue","onUpdate:modelValue","options","placeholder","class"])]),a("div",z,[a("label",H,i(t.$t("recommendations")),1),o(G,{"bg-color":"#EAE8E9",rows:"3",modelValue:s.student.recommendations,"onUpdate:modelValue":e[2]||(e[2]=l=>s.student.recommendations=l)},null,8,["modelValue"])])]),s.student.program_id&&s.setiontype!=1?(m(),u("table",{key:0,class:c([{"animate__animated animate__bounce animate__delay-0s":s.error.balance},"item-table w-[70%]"])},[a("thead",null,[a("tr",null,[a("th",null,i(t.$t("Typetreatment")),1),a("th",null,i(t.$t("number_sessaion")),1),J])]),a("tbody",null,[(m(!0),u(x,null,S(s.capasity,(l,b)=>(m(),u("tr",{key:b},[a("td",null,i(l.name),1),a("td",null,i(l.sessions_number),1),a("td",null,i(s.maxcapsity),1),a("td",null,[o(_,{onClick:et=>d.deleteitem(b),icon:"pi pi-trash",class:"p-button-rounded delete p-button-success m-auto"},null,8,["onClick"])])]))),128)),s.student.program_id&&s.maxcapsity>0&&s.setiontype!=1?(m(),u("tr",K,[a("td",null,[o(h,{required:"",id:"pv_id_1",style:{direction:"ltr !important"},modelValue:s.student.Type,"onUpdate:modelValue":e[3]||(e[3]=l=>s.student.Type=l),"option-value":"id",filter:"",options:s.treaments,optionLabel:"name",placeholder:t.$t("Typetreatment"),class:c(["w-full",{"p-invalid":s.submitted&&!s.student.Type}])},null,8,["modelValue","options","placeholder","class"])]),a("td",null,[o(v,{max:s.maxcapsity,min:1,class:"bg-[#f7f5f5] w-full",modelValue:s.student.sessions_number,"onUpdate:modelValue":e[4]||(e[4]=l=>s.student.sessions_number=l),placeholder:t.$t("Sn")},null,8,["max","modelValue","placeholder"])]),a("td",null,i(s.maxcapsity),1),a("td",null,[o(_,{onClick:d.addarray,type:"submit",class:"create m-auto s",icon:"pi pi-plus"},null,8,["onClick"])])])):g("",!0)])],2)):g("",!0),o(V),a("div",Q,[o(C,{options:s.opts,class:"h-[400px]",onChange:e[5]||(e[5]=l=>d.refreshEvents()),ref:"fullCalendar",dayRender:d.highlightSelectedDay},null,8,["options","dayRender"]),(y=s.error)!=null&&y.time_slots?(m(),u("div",X,i(s.error.time_slots[0]),1)):g("",!0),Y,a("div",Z,[o(_,{type:"submit ",onClick:e[6]||(e[6]=l=>s.submitted=!0),class:"create m-auto w-full lg:w-[50%]",label:t.$t("submit")},null,8,["label"])])])],32)]}),_:1})],64)}const ot=w(I,[["render",$]]);export{ot as default};
