import{as as B,bP as U,aB as Q,f as a,K as C,bQ as N,au as O,bR as Y,bS as T,b8 as _,b3 as F,ay as G,aw as j,aF as H,aG as K,bT as L,F as $,bU as z,bV as J,aK as W,_ as X,a as Z,Q as q,c as b,r as I,o as m,d as p,g as w,V as ee,h as te,t as g,ab as se,e as c,w as ae,ap as le,j as D,x as A}from"./main-7f465f8a.js";import{h as S}from"./moment-fbc5633a.js";import{V as ie}from"./VForm-bac7b4fe.js";import{V as oe}from"./VSheet-ec9d3a84.js";const x=B({name:"VRadio",props:{...U({falseIcon:"$radioOff",trueIcon:"$radioOn"})},setup(e,t){let{slots:l}=t;return Q(()=>a(N,C(e,{class:"v-radio",type:"radio"}),l)),{}}});const re=B({name:"VRadioGroup",inheritAttrs:!1,props:{height:{type:[Number,String],default:"auto"},...O(),...Y(T(),["multiple"]),trueIcon:{type:_,default:"$radioOn"},falseIcon:{type:_,default:"$radioOff"},type:{type:String,default:"radio"}},emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:l,slots:i}=t;const h=F(),o=G(()=>e.id||`radio-group-${h}`),n=j(e,"modelValue");return Q(()=>{const[f,d]=H(l),[s,u]=K(e),[r,k]=L({...e,multiple:!1}),v=i.label?i.label({label:e.label,props:{for:o.value}}):e.label;return a(W,C({class:"v-radio-group"},f,s,{modelValue:n.value,"onUpdate:modelValue":V=>n.value=V,id:o.value}),{...i,default:V=>{let{id:y,messagesId:R,isDisabled:E,isReadonly:M}=V;return a($,null,[v&&a(z,{id:y.value},{default:()=>[v]}),a(J,C(r,{id:y.value,"aria-describedby":R.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:E.value,readonly:M.value,"aria-labelledby":v?y.value:void 0},d,{modelValue:n.value,"onUpdate:modelValue":P=>n.value=P}),i)])}})}),{}}}),de={components:{InputText:Z,Calendar:q},data:()=>({valu:"",NameRules:[e=>e?!0:"This field is required"],title:"",skills:[],skill:{},answers:[],error:{},type:"success",snackbar:!0,load:!1,selected:[],children:[],selectBox:[],c:{},child_id:"",child:"",numberOfMonth:"",skip:[],headerAndQuestions:[],examDate:""}),methods:{fomate(){},goBack(){this.$router.go(-1)},getQuestions(){b.get(`/api/side-profile-types/${this.$route.params.id}`).then(e=>{const t=e.data.data.evaluation_header;this.title=e.data.data.title,t.forEach(l=>{const i=l.id;this.headerAndQuestions[i]||(this.headerAndQuestions[i]=[]),this.headerAndQuestions[i].push(l)})}),console.log(this.headerAndQuestions)},async submit(){this.load=!0,setTimeout(()=>{this.load=!1},3e3);const{valid:e}=await this.$refs.form.validate();e&&(this.answers=[],this.selected.forEach((t,l)=>{this.answers.push({question_id:l,value:t})}),this.examDate=S(new Date).format("YYYY-MM-DD HH:mm"),b.post(`/api/evaluations/${this.$route.params.id}/submit`,{answers:this.answers,child_id:this.child_id,date:this.examDate,skills:this.skills}).then(t=>{t.data.status==200&&(this.child.childInMonths=-1,this.type="success")}).catch(t=>{this.error=t.data,this.type="error"}))},getChildren(){b.get("/api/child").then(e=>{this.children=e.data.children.forEach(t=>{this.selectBox.push({title:t.name,value:t.id})})})},radioChange(e,t,l){let i=0;if(this.skip[t]==null)this.skip[t]=[{id:l,answer:e}];else{let d=this.skip[t];d.forEach(s=>{s.id==l&&(i++,s.answer=e)}),i||(d.push({id:l,answer:e}),this.skip[t]=d)}let h=0,o=0,n=-1,f=-1;Object.entries(this.skip).reverse().forEach(d=>{const[s,u]=d;n=f,f=s;for(const r of u)if(r.answer==1)h++;else{h=0;break}if(h?(this.headerAndQuestions[s].length==h&&o++,h=0):o=0,o==2){for(const r of Object.entries(this.headerAndQuestions)){const[k,v]=r;if(s==k)break;v.forEach(V=>{this.selected[V.questions.id]=1})}this.answers=[],this.selected.forEach((r,k)=>{this.answers.push({question_id:k,value:r})}),b.post(`/api/evaluations/${this.$route.params.id}/${n}/basalAge`,{answers:this.answers,child_id:this.child_id,date:this.examDate,skills:this.skills}).then(r=>{console.log(r.data.resultEvaluation)}),this.$router.push({name:"Children",params:{alert:1}})}})},getallskills(){b.get("/api/skills").then(e=>{this.skill=e.data.data})},getSpecificChildren(){b.get(`/api/child/${this.child_id}/${this.$route.params.id}`).then(e=>{console.log(e.data.child),e.data.child.canDoExam?(this.alert_text="",this.child=e.data.child):(this.alert_text="sorry this child has this evaluate lass than 6 months",this.type="error",this.child=e.data.child,this.child.childInMonths=-1)})}},mounted(){this.getQuestions(),this.getChildren(),this.getallskills(),this.examDate=S(new Date).format("YYYY-MM-DD HH:mm"),console.log(this.examDate)}},ne={class:"text-center"},ue={class:"grid grid-cols-1 lg:grid-cols-2 gap-5"},he={class:"flex flex-column gap-2 py-2"},ce={class:"w-full text-right",for:"username"},me={key:0,class:"mt-1 mb-5 text-red-500"},pe={key:0},fe={class:"font-weight-bold mb-3 mx-7"},be={class:"border border-1 rounded pa-5"},ge={class:"mb-3"},ve=c("div",{class:"mb-7"},null,-1);function Ve(e,t,l,i,h,o){const n=I("Calendar"),f=I("Button");return m(),p("div",null,[a(se,{height:"45",class:"mb-5 text-white",color:"#A9AB7F",onClick:o.goBack},{default:w(()=>[a(ee,{start:"",icon:"mdi-arrow-left"}),te(" "+g(e.$t("back")),1)]),_:1},8,["onClick"]),a(oe,{"max-width":"1200",class:"mx-auto"},{default:w(()=>[c("h1",ne,g(e.title),1),a(ie,{"fast-fail":"",ref:"form",onSubmit:ae(o.submit,["prevent"]),class:"shadow-lg lg:p-[2%]"},{default:w(()=>{var d;return[a(le,{label:"Child",modelValue:e.child_id,"onUpdate:modelValue":[t[0]||(t[0]=s=>e.child_id=s),o.getSpecificChildren],items:e.selectBox},null,8,["modelValue","onUpdate:modelValue","items"]),c("div",ue,[c("div",he,[c("label",ce,g(e.$t("created_at")),1),a(n,{style:{width:"100%"},modelValue:e.examDate,"onUpdate:modelValue":t[1]||(t[1]=s=>e.examDate=s),onChange:t[2]||(t[2]=s=>o.fomate()),"date-format":"dd-mm-yy",showIcon:"",rules:e.NameRules,"show-time":!0},null,8,["modelValue","rules"]),(d=e.error)!=null&&d.permissions?(m(),p("div",me,g(e.error.permissions[0]),1)):D("",!0)])]),(m(!0),p($,null,A(Object.values(e.headerAndQuestions).reverse(),s=>(m(),p("div",null,[s[0].min_age<=this.child.childInMonths?(m(),p("div",pe,[c("ul",null,[c("li",fe,g(s[0].title),1)]),(m(!0),p($,null,A(s,u=>(m(),p("div",be,[c("div",ge,g(u.questions.title),1),a(re,{modelValue:e.selected[u.questions.id],"onUpdate:modelValue":r=>e.selected[u.questions.id]=r,onChange:r=>o.radioChange(e.selected[u.questions.id],u.questions.evaluation_header_id,u.questions.id),rules:e.NameRules},{default:w(()=>[a(x,{label:"True",value:"1"}),a(x,{label:"False",value:"0"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","rules"])]))),256))])):D("",!0),ve]))),256)),a(f,{loading:e.load,type:"submit",class:"create m-auto w-[50%] my-4",label:e.$t("submit")},null,8,["loading","label"])]}),_:1},8,["onSubmit"])]),_:1})])}const $e=X(de,[["render",Ve]]);export{$e as default};
